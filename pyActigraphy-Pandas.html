<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>How to read data from DataFrames with pyActigraphy &#8212; pyActigraphy 1.Orc1 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/jquery-1.11.0.min.js"></script>
    <script src="_static/js/jquery-fix.js"></script>
    <script src="_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-inverse navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          pyActigraphy</a>
        <span class="navbar-text navbar-version pull-left"><b>1.Orc1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="tutorials.html">Tutorials</a></li>
                <li><a href="api.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/pyActigraphy-Pandas.ipynb.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="How-to-read-data-from-DataFrames-with-pyActigraphy">
<h1>How to read data from DataFrames with pyActigraphy<a class="headerlink" href="#How-to-read-data-from-DataFrames-with-pyActigraphy" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Imported-packages-and-input-data">
<h2>Imported packages and input data<a class="headerlink" href="#Imported-packages-and-input-data" title="Permalink to this headline">¶</a></h2>
<p>The usual suspects:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">pyActigraphy</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.7/site-packages/statsmodels/tools/_testing.py:19: FutureWarning: pandas.util.testing is deprecated. Use the functions in the public API at pandas.testing instead.
  import pandas.util.testing as tm
</pre></div></div>
</div>
<p>In this example, let’s generate some input data:</p>
<p>NB: if you already have your data under a pandas.DataFrame format, jump
directly to the next section.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1440</span><span class="o">*</span><span class="mi">7</span> <span class="c1"># 7 days of acquisition at a frequency of 60s.</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">activity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
<span class="n">light</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">non_wear</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Set up a segment of  spurious inactivity</span>
<span class="n">activity</span><span class="p">[</span><span class="mi">2060</span><span class="p">:</span><span class="mi">2160</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">non_wear</span><span class="p">[</span><span class="mi">2060</span><span class="p">:</span><span class="mi">2160</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Activity&#39;</span><span class="p">:</span> <span class="n">activity</span><span class="p">,</span> <span class="s1">&#39;Light&#39;</span><span class="p">:</span> <span class="n">light</span><span class="p">,</span> <span class="s1">&#39;Non-wear&#39;</span><span class="p">:</span> <span class="n">non_wear</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s1">&#39;01-01-2020&#39;</span><span class="p">,</span><span class="n">freq</span><span class="o">=</span><span class="s1">&#39;60s&#39;</span><span class="p">,</span><span class="n">periods</span><span class="o">=</span><span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Activity</th>
      <th>Light</th>
      <th>Non-wear</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00</th>
      <td>9.803906</td>
      <td>97.208266</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-01 00:01:00</th>
      <td>11.322234</td>
      <td>106.991005</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-01 00:02:00</th>
      <td>8.204245</td>
      <td>99.137269</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-01 00:03:00</th>
      <td>8.867003</td>
      <td>99.459600</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-01 00:04:00</th>
      <td>9.187778</td>
      <td>90.814416</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2020-01-07 23:55:00</th>
      <td>7.516059</td>
      <td>83.467992</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-07 23:56:00</th>
      <td>10.156999</td>
      <td>91.532551</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-07 23:57:00</th>
      <td>10.241579</td>
      <td>96.630307</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-07 23:58:00</th>
      <td>10.751310</td>
      <td>97.703363</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-07 23:59:00</th>
      <td>9.172097</td>
      <td>110.284720</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>10080 rows × 3 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Manual-creation-of-a-BaseRaw-object">
<h2>Manual creation of a BaseRaw object<a class="headerlink" href="#Manual-creation-of-a-BaseRaw-object" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pyActigraphy.io</span> <span class="k">import</span> <span class="n">BaseRaw</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">help</span><span class="p">(</span><span class="n">BaseRaw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Help on class BaseRaw in module pyActigraphy.io.base:

class BaseRaw(pyActigraphy.sleep.sleep.SleepBoutMixin, pyActigraphy.sleep.scoring_base.ScoringMixin, pyActigraphy.metrics.metrics.MetricsMixin, pyActigraphy.filters.filters.FiltersMixin)
 |  BaseRaw(name, uuid, format, axial_mode, start_time, period, frequency, data, light)
 |
 |  Base class for raw data.
 |
 |  Method resolution order:
 |      BaseRaw
 |      pyActigraphy.sleep.sleep.SleepBoutMixin
 |      pyActigraphy.sleep.scoring_base.ScoringMixin
 |      pyActigraphy.metrics.metrics.MetricsMixin
 |      pyActigraphy.filters.filters.FiltersMixin
 |      builtins.object
 |
 |  Methods defined here:
 |
 |  __init__(self, name, uuid, format, axial_mode, start_time, period, frequency, data, light)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |
 |  binarized_data(self, threshold)
 |      Boolean thresholding of Pandas Series
 |
 |  duration(self)
 |      Duration (in days, hours, etc) of the data acquistion period
 |
 |  length(self)
 |      Number of data acquisition points
 |
 |  mask_fraction(self)
 |      Fraction of masked data
 |
 |  read_sleep_diary(self, input_fname, header_size=2, state_index={&#39;ACTIVE&#39;: 2, &#39;NAP&#39;: 1, &#39;NIGHT&#39;: 0, &#39;NOWEAR&#39;: -1}, state_colour={&#39;NAP&#39;: &#39;#7bc043&#39;, &#39;NIGHT&#39;: &#39;#d3d3d3&#39;, &#39;NOWEAR&#39;: &#39;#ee4035&#39;})
 |      Reader function for sleep diaries.
 |
 |      Parameters
 |      ----------
 |      input_fname: str
 |          Path to the sleep diary file.
 |      header_size: int
 |          Header size (i.e. number of lines) of the sleep diary.
 |          Default is 2.
 |      state_index: dict
 |          The dictionnary of state&#39;s indices.
 |          Default is ACTIVE=2, NAP=1, NIGHT=0, NOWEAR=-1.
 |      state_color: dict
 |          The dictionnary of state&#39;s colours.
 |          Default is NAP=&#39;#7bc043&#39;, NIGHT=&#39;#d3d3d3&#39;, NOWEAR=&#39;#ee4035&#39;.
 |
 |  resampled_data(self, freq, binarize=False, threshold=0)
 |      Data resampled at the specified frequency.
 |      If mask_inactivity is True, the `mask` is used to filter inactive data.
 |
 |  resampled_light(self, freq)
 |      Light measurement, resampled at the specified frequency.
 |
 |  time_range(self)
 |      Range (in days, hours, etc) of the data acquistion period
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |
 |  axial_mode
 |      Acquistion mode (mono-axial or tri-axial)
 |
 |  data
 |      Indexed data extracted from the raw file.
 |      If mask_inactivity is set to true, the `mask` is used
 |      to filter out inactive data.
 |
 |  display_name
 |      Name to be used for display.
 |
 |  exclude_if_mask
 |      Boolean to exclude partially masked data when resampling
 |
 |  format
 |      Format of the raw data file (AWD,RPX,MTN,...)
 |
 |  frequency
 |      Acquisition frequency as extracted from the raw file.
 |
 |  inactivity_length
 |      Length of the inactivity mask.
 |
 |  light
 |      Indexed light extracted from the raw file.
 |      If mask_inactivity is set to true, the `mask` is used
 |      to filter out inactive data.
 |
 |  mask
 |      Mask used to filter out inactive data.
 |
 |  mask_inactivity
 |      Switch to mask inactive data.
 |
 |  name
 |      Study name as extracted from the raw file.
 |
 |  period
 |      Period of data acquistion as extracted from the raw file or
 |      specified by the user.
 |
 |  raw_data
 |      Indexed data extracted from the raw file.
 |
 |  raw_light
 |      Light measurement performed by the device
 |
 |  sleep_diary
 |      :class:`SleepDiary` class instanciation.
 |
 |  start_time
 |      Start time of data acquistion as extracted from the raw file or
 |      specified by the user.
 |
 |  uuid
 |      UUID of the device used to acquire the data
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from pyActigraphy.sleep.sleep.SleepBoutMixin:
 |
 |  active_bouts(self, duration_min=None, duration_max=None, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Active bouts.
 |
 |      Activity periods identified as active.
 |
 |      Parameters
 |      ----------
 |      duration_min: str,optional
 |          Minimal time duration for an active period.
 |          Default is None (no filtering).
 |      duration_max: str,optional
 |          Maximal time duration for an active period.
 |          Default is None (no filtering).
 |      algo: str, optional
 |          Sleep/wake scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      active_bouts: a list of pandas.Series
 |
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; raw.active_bouts(duration_min=&#39;2h&#39;, algo=&#39;Roenneberg&#39;)
 |          XXX
 |
 |  active_durations(self, duration_min=None, duration_max=None, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Duration of the active bouts.
 |
 |      Duration of the activity periods identified as active.
 |
 |      Parameters
 |      ----------
 |      duration_min: str,optional
 |          Minimal time duration for an active period.
 |          Default is None (no filtering).
 |      duration_max: str,optional
 |          Maximal time duration for an active period.
 |          Default is None (no filtering).
 |      algo: str, optional
 |          Sleep/wake scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      active_durations: a list of pandas.TimeDelta
 |
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; raw.active_durations(duration_min=&#39;2h&#39;, algo=&#39;Roenneberg&#39;)
 |          XXX
 |
 |  sleep_bouts(self, duration_min=None, duration_max=None, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Sleep bouts.
 |
 |      Activity periods identified as sleep.
 |
 |      Parameters
 |      ----------
 |      duration_min: str,optional
 |          Minimal time duration for a sleep period.
 |          Default is None (no filtering).
 |      duration_max: str,optional
 |          Maximal time duration for a sleep period.
 |          Default is None (no filtering).
 |      algo: str, optional
 |          Sleep/wake scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      sleep_bouts: a list of pandas.Series
 |
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; raw.sleep_bouts(duration_min=&#39;2h&#39;, algo=&#39;Roenneberg&#39;)
 |          XXX
 |
 |  sleep_durations(self, duration_min=None, duration_max=None, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Duration of the sleep bouts.
 |
 |      Duration of the activity periods identified as sleep.
 |
 |      Parameters
 |      ----------
 |      duration_min: str,optional
 |          Minimal time duration for a sleep period.
 |          Default is None (no filtering).
 |      duration_max: str,optional
 |          Maximal time duration for a sleep period.
 |          Default is None (no filtering).
 |      algo: str, optional
 |          Sleep/wake scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      sleep_durations: a list of pandas.TimeDelta
 |
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; raw.sleep_durations(duration_min=&#39;2h&#39;, algo=&#39;Roenneberg&#39;)
 |          XXX
 |
 |  ----------------------------------------------------------------------
 |  Data descriptors inherited from pyActigraphy.sleep.sleep.SleepBoutMixin:
 |
 |  __dict__
 |      dictionary for instance variables (if defined)
 |
 |  __weakref__
 |      list of weak references to the object (if defined)
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from pyActigraphy.sleep.scoring_base.ScoringMixin:
 |
 |  AoffT(self, freq=&#39;5min&#39;, whs=12, binarize=True, threshold=4)
 |      Activity offset time.
 |
 |      Activity offset time derived from the daily activity profile.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Data resampling `frequency string
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.
 |          Default is &#39;5min&#39;.
 |      whs: int, optional
 |          Window half size.
 |          Default is 12.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |
 |      Returns
 |      -------
 |      aot: Timedelta
 |          Activity offset time.
 |
 |
 |      Notes
 |      -----
 |
 |      This automatic detection of the activity offset time is based on the
 |      daily activity profile. It returns the time point where relative
 |      difference between the mean activity over :math:`whs` epochs after and
 |      before this time point is maximum:
 |
 |      .. math::
 |          AoffT = \max_{t}(
 |          \frac{\sum_{i=1}^{whs} x_{t+i}}{\sum_{i=-whs}^{0} x_{t+i}} - 1
 |          )
 |
 |      with:
 |
 |      * :math:`x_{i}` is the activity count at time :math:`i`.
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; raw.AoffT()
 |          Timedelta(&#39;0 days 23:20:00&#39;)
 |          &gt;&gt;&gt; raw.AoffT(binarize=False)
 |          Timedelta(&#39;0 days 23:05:00&#39;)
 |
 |  AonT(self, freq=&#39;5min&#39;, whs=12, binarize=True, threshold=4)
 |      Activity onset time.
 |
 |      Activity onset time derived from the daily activity profile.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Data resampling `frequency string
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.
 |          Default is &#39;5min&#39;.
 |      whs: int, optional
 |          Window half size.
 |          Default is 12.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |
 |      Returns
 |      -------
 |      aot: Timedelta
 |          Activity onset time.
 |
 |
 |      Notes
 |      -----
 |
 |      This automatic detection of the activity onset time is based on the
 |      daily activity profile. It returns the time point where difference
 |      between the mean activity over :math:`whs` epochs before and after this
 |      time point is maximum:
 |
 |      .. math::
 |          AonT = \max_{t}(
 |          \frac{\sum_{i=-whs}^{0} x_{t+i}}{\sum_{i=1}^{whs} x_{t+i}} - 1
 |          )
 |
 |      with:
 |
 |      * :math:`x_{i}` is the activity count at time :math:`i`.
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; raw.AonT()
 |          Timedelta(&#39;0 days 07:15:00&#39;)
 |          &gt;&gt;&gt; raw.AonT(binarize=False)
 |          Timedelta(&#39;0 days 07:05:00&#39;)
 |
 |  CK(self, scale=1e-05, window=array([ 400,  600,  300,  400, 1400,  500,  350,    0,    0], dtype=int32), threshold=1.0)
 |      Cole&amp;Kripke algorithm for sleep-wake identification.
 |
 |      Algorithm for automatic sleep scoring based on wrist activity,
 |      developped by Cole, Kripke et al [1]_.
 |
 |
 |      Parameters
 |      ----------
 |      scale: float, optional
 |          Scale parameter P.
 |          Default is 0.00001.
 |      window: np.array
 |          Array of weighting factors, :math:`W_{i}`.
 |          Default is [400, 600, 300, 400, 1400, 500, 350, 0, 0]
 |      threshold: float, optional
 |          Threshold value for scoring sleep/wake.
 |          Default is 1.0.
 |
 |      Returns
 |      -------
 |      ck: pandas.core.Series
 |          Time series containing the `D` scores (0: sleep, 1: wake) for each
 |          epoch.
 |
 |      Notes
 |      -----
 |
 |      The output variable D of the CK algorithm is defined in [1]_ as:
 |
 |      .. math::
 |
 |          D = P*(
 |              [W_{-4},\dots,W_{0},\dots,W_{+2}]
 |              \cdot
 |              [A_{-4},\dots,A_{0},\dots,A_{+2}])
 |
 |      with:
 |
 |      * D &lt; 1 == sleep, D &gt;= 1 == wake;
 |      * P, scale factor;
 |      * :math:`W_{0},W_{-1},W_{+1},\dots`, weighting factors for the present
 |        minute, the previous minute, the following minute, etc.;
 |      * :math:`A_{0},A_{-1},A_{+1},\dots`, activity scores for the present
 |        minute, the previous minute, the following minute, etc.
 |
 |
 |      References
 |      ----------
 |
 |      .. [1] Cole, R. J., Kripke, D. F., Gruen, W., Mullaney, D. J.,
 |             &amp; Gillin, J. C. (1992). Automatic Sleep/Wake Identification
 |             From Wrist Activity. Sleep, 15(5), 461–469.
 |             http://doi.org/10.1093/sleep/15.5.461
 |
 |      Examples
 |      --------
 |
 |  Crespo(self, zeta=15, zeta_r=30, zeta_a=2, t=0.33, alpha=&#39;8h&#39;, beta=&#39;1h&#39;, estimate_zeta=False, seq_length_max=100, verbose=False)
 |      Crespo algorithm for activity/rest identification
 |
 |      Algorithm for automatic identification of activity-rest periods based
 |      on actigraphy, developped by Crespo et al. [1]_.
 |
 |      Parameters
 |      ----------
 |      zeta: int, optional
 |          Maximum number of consecutive zeroes considered valid.
 |          Default is 15.
 |      zeta_r: int, optional
 |          Maximum number of consecutive zeroes considered valid (rest).
 |          Default is 30.
 |      zeta_a: int, optional
 |          Maximum number of consecutive zeroes considered valid (active).
 |          Default is 2.
 |      t: float, optional
 |          Percentile for invalid zeroes.
 |          Default is 0.33.
 |      alpha: str, optional
 |          Average hours of sleep per night.
 |          Default is &#39;8h&#39;.
 |      beta: str, optional
 |          Length of the padding sequence used during the processing.
 |          Default is &#39;1h&#39;.
 |      estimate_zeta: bool, optional
 |          If set to True, zeta values are estimated from the distribution of
 |          ratios of the number of series of consecutive zeroes to
 |          the number of series randomly chosen from the actigraphy data.
 |          Default is False.
 |      seq_length_max: int, optional
 |          Maximal length of the aforementioned random series.
 |          Default is 100.
 |      verbose: bool, optional
 |          If set to True, print the estimated values of zeta.
 |          Default is False.
 |
 |      Returns
 |      -------
 |      crespo : pandas.core.Series
 |          Time series containing the estimated periods of rest (0) and
 |          activity (1).
 |
 |      References
 |      ----------
 |
 |      .. [1] Crespo, C., Aboy, M., Fernández, J. R., &amp; Mojón, A. (2012).
 |             Automatic identification of activity–rest periods based on
 |             actigraphy. Medical &amp; Biological Engineering &amp; Computing, 50(4),
 |             329–340. http://doi.org/10.1007/s11517-012-0875-y
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; crespo = rawAWD.Crespo()
 |          &gt;&gt;&gt; crespo
 |          2018-03-26 14:16:00    1
 |          2018-03-26 14:17:00    0
 |          2018-03-26 14:18:00    0
 |          (...)
 |          2018-04-06 08:22:00    0
 |          2018-04-06 08:23:00    0
 |          2018-04-06 08:24:00    1
 |          Length: 15489, dtype: int64
 |
 |  Crespo_AoT(self, zeta=15, zeta_r=30, zeta_a=2, t=0.33, alpha=&#39;8h&#39;, beta=&#39;1h&#39;, estimate_zeta=False, seq_length_max=100, verbose=False)
 |      Automatic identification of activity onset/offset times, based on
 |      the Crespo algorithm.
 |
 |      Identification of the activity onset and offset times using the
 |      algorithm for automatic identification of activity-rest periods based
 |      on actigraphy, developped by Crespo et al. [1]_.
 |
 |      Parameters
 |      ----------
 |      zeta: int
 |          Maximum number of consecutive zeroes considered valid.
 |          Default is 15.
 |      zeta_r: int
 |          Maximum number of consecutive zeroes considered valid (rest).
 |          Default is 30.
 |      zeta_a: int
 |          Maximum number of consecutive zeroes considered valid (active).
 |          Default is 2.
 |      t: float
 |          Percentile for invalid zeroes.
 |          Default is 0.33.
 |      alpha: offset
 |          Average hours of sleep per night.
 |          Default is &#39;8h&#39;.
 |      beta: offset
 |          Length of the padding sequence used during the processing.
 |          Default is &#39;1h&#39;.
 |      estimate_zeta: Boolean
 |          If set to True, zeta values are estimated from the distribution of
 |          ratios of the number of series of consecutive zeroes to
 |          the number of series randomly chosen from the actigraphy data.
 |          Default is False.
 |      seq_length_max: int
 |          Maximal length of the aforementioned random series.
 |          Default is 100.
 |      verbose:
 |          If set to True, print the estimated values of zeta.
 |          Default is False.
 |
 |      Returns
 |      -------
 |      aot : (ndarray, ndarray)
 |          Arrays containing the estimated activity onset and offset times,
 |          respectively.
 |
 |      References
 |      ----------
 |
 |      .. [1] Crespo, C., Aboy, M., Fernández, J. R., &amp; Mojón, A. (2012).
 |             Automatic identification of activity–rest periods based on
 |             actigraphy. Medical &amp; Biological Engineering &amp; Computing, 50(4),
 |             329–340. http://doi.org/10.1007/s11517-012-0875-y
 |
 |      Examples
 |      --------
 |
 |  Oakley(self, threshold=40)
 |      Oakley&#39;s algorithm for sleep/wake scoring.
 |
 |      Algorithm for automatic sleep/wake scoring based on wrist activity,
 |      developed by Oakley [1]_.
 |
 |
 |      Parameters
 |      ----------
 |      threshold: float or str, optional
 |          Threshold value for scoring sleep/wake. Can be set to &#34;automatic&#34;
 |          (cf. Notes).
 |          Default is 40.
 |
 |      Returns
 |      -------
 |
 |      oakley: pandas.core.Series
 |          Time series containing scores (1: sleep, 0: wake) for each
 |          epoch.
 |
 |
 |      Notes
 |      -----
 |
 |      The output variable O of Oakley&#39;s algorithm is defined as:
 |
 |      .. math::
 |
 |          O = (
 |              [W_{-2},W_{-1},W_{0},W_{+1},W_{+2}]
 |              \cdot
 |              [A_{-2},A_{-1},A_{0},A_{+1},A_{+2}])
 |
 |      with:
 |
 |      * O &lt;= threshold == sleep, 0 &gt; threshold == wake;
 |      * :math:`W_{0},W_{-1},W_{+1},\dots`, weighting factors for the present
 |        epoch, the previous epoch, the following epoch, etc.;
 |      * :math:`A_{0},A_{-1},A_{+1},\dots`, activity scores for the present
 |        epoch, the previous epoch, the following epoch, etc.
 |
 |
 |      The current implementation of this algorithm follows the description
 |      provided in the instruction manual of the Actiwatch Communication and
 |      Sleep Analysis Software (Respironics, Inc.) [2]_ :
 |
 |      * 15-second sampling frequency:
 |          .. math::
 |
 |              W_{-8} &amp;= \ldots = W_{-5} = W_{+5} = \ldots = W_{+8} = 1/25 \\
 |              W_{-4} &amp;= \ldots = W_{-1} = W_{+1} = \ldots = W_{+4} = 1/5 \\
 |              W_{0} &amp;= 4
 |
 |      * 30-second sampling frequency:
 |          .. math::
 |
 |              W_{-4} &amp;= W_{-3} = W_{+3} = W_{+4} = 1/25 \\
 |              W_{-2} &amp;= W_{-1} = W_{+1} = W_{+2} = 1/5 \\
 |              W_{0} &amp;= 2
 |
 |      * 60-second sampling frequency:
 |          .. math::
 |
 |              W_{-2} &amp;= W_{+2} = 1/25 \\
 |              W_{-1} &amp;= W_{+1} = 1/5 \\
 |              W_{0} &amp;= 1
 |
 |      * 120-second sampling frequency:
 |          .. math::
 |
 |              W_{-1} &amp;= W_{+1} = 1/8 \\
 |              W_{0} &amp;= 1/2
 |
 |
 |      The *Automatic Wake Threshold Value* calculation is this [2]_:
 |
 |      1. Sum the activity counts for all epochs of the data set.
 |      2. Count the number of epochs scored as MOBILE for the data set
 |         (the definition of MOBILE follows).
 |      3. Compute the MOBILE TIME (number of epochs scored as MOBILE from
 |         step 2 multiplied by the Epoch Length) in minutes.
 |      4. Compute the Auto Wake Threshold = ((sum of activity counts from
 |         step 1) divided by (MOBILE TIME from step 3)) multiplied by 0.88888.
 |
 |
 |      *Definition of Mobile* [2]_:
 |
 |      An epoch is scored as MOBILE if the number of activity counts recorded
 |      in that epoch is greater than or equal to the epoch length in 15-second
 |      intervals. For example,there are four 15-second intervals for a
 |      1-minute epoch length; hence, the activity value in an epoch must be
 |      greater than, or equal to, four, to be scored as MOBILE.
 |
 |
 |      References
 |      ----------
 |
 |      .. [1] Oakley, N.R. Validation with Polysomnography of the Sleepwatch
 |             Sleep/Wake Scoring Algorithm Used by the Actiwatch Activity
 |             Monitoring System; Technical Report; Mini-Mitter: Bend, OR, USA,
 |             1997
 |      .. [2] Instruction manual, Actiwatch Communication and Sleep Analysis
 |             Software
 |             (https://fccid.io/JIAAWR1/Users-Manual/USERS-MANUAL-1-920937)
 |
 |  Roenneberg(self, trend_period=&#39;24h&#39;, min_trend_period=&#39;12h&#39;, threshold=0.15, min_seed_period=&#39;30Min&#39;, max_test_period=&#39;12h&#39;, n_succ=3)
 |      Automatic sleep detection.
 |
 |      Identification of consolidated sleep episodes using the
 |      algorithm developped by Roenneberg et al. [1]_.
 |
 |      Parameters
 |      ----------
 |      trend_period: str, optional
 |          Time period of the rolling window used to extract the data trend.
 |          Default is &#39;24h&#39;.
 |      min_trend_period: str, optional
 |          Minimum time period required for the rolling window to produce a
 |          value. Values default to NaN otherwise.
 |          Default is &#39;12h&#39;.
 |      threshold: float, optional
 |          Fraction of the trend to use as a threshold for sleep/wake
 |          categorization.
 |          Default is &#39;0.15&#39;
 |      min_seed_period: str, optional
 |          Minimum time period required to identify a potential sleep onset.
 |          Default is &#39;30Min&#39;.
 |      max_test_period : str, optional
 |          Maximal period of the test series.
 |          Default is &#39;12h&#39;
 |      n_succ : int, optional
 |          Number of successive elements to consider when searching for the
 |          maximum correlation peak.
 |
 |      Returns
 |      -------
 |      rbg : pandas.core.Series
 |          Time series containing the estimated periods of rest (1) and
 |          activity (0).
 |
 |      References
 |      ----------
 |
 |      .. [1] Roenneberg, T., Keller, L. K., Fischer, D., Matera, J. L.,
 |             Vetter, C., &amp; Winnebeck, E. C. (2015). Human Activity and Rest
 |             In Situ. In Methods in Enzymology (Vol. 552, pp. 257-283).
 |             http://doi.org/10.1016/bs.mie.2014.11.028
 |
 |      Examples
 |      --------
 |
 |  Roenneberg_AoT(self, trend_period=&#39;24h&#39;, min_trend_period=&#39;12h&#39;, threshold=0.15, min_seed_period=&#39;30Min&#39;, max_test_period=&#39;12h&#39;, n_succ=3)
 |      Automatic identification of activity onset/offset times, based on
 |      Roenneberg&#39;s algorithm.
 |
 |      Identification of the activity onset and offset times using the
 |      algorithm for automatic identification of consolidated sleep episodes
 |      developped by Roenneberg et al. [1]_.
 |
 |      Parameters
 |      ----------
 |      trend_period: str, optional
 |          Time period of the rolling window used to extract the data trend.
 |          Default is &#39;24h&#39;.
 |      min_trend_period: str, optional
 |          Minimum time period required for the rolling window to produce a
 |          value. Values default to NaN otherwise.
 |          Default is &#39;12h&#39;.
 |      threshold: float, optional
 |          Fraction of the trend to use as a threshold for sleep/wake
 |          categorization.
 |          Default is &#39;0.15&#39;
 |      min_seed_period: str, optional
 |          Minimum time period required to identify a potential sleep onset.
 |          Default is &#39;30Min&#39;.
 |      max_test_period : str, optional
 |          Maximal period of the test series.
 |          Default is &#39;12h&#39;.
 |      n_succ : int, optional
 |          Number of successive elements to consider when searching for the
 |          maximum correlation peak.
 |
 |      Returns
 |      -------
 |      aot : (ndarray, ndarray)
 |          Arrays containing the estimated activity onset and offset times,
 |          respectively.
 |
 |      References
 |      ----------
 |
 |      .. [1] Roenneberg, T., Keller, L. K., Fischer, D., Matera, J. L.,
 |             Vetter, C., &amp; Winnebeck, E. C. (2015). Human Activity and Rest
 |             In Situ. In Methods in Enzymology (Vol. 552, pp. 257-283).
 |             http://doi.org/10.1016/bs.mie.2014.11.028
 |
 |      Examples
 |      --------
 |
 |  Sadeh(self, offset=7.601, weights=array([-0.065, -1.08 , -0.056, -0.703]), threshold=0.0)
 |      Sadeh algorithm for sleep identification
 |
 |      Algorithm for automatic sleep scoring based on wrist activity,
 |      developped by Sadeh et al [1]_.
 |
 |      Parameters
 |      ----------
 |      offset: float, optional
 |          Offset parameter.
 |          Default is 7.601.
 |      weights: np.array
 |          Array of weighting factors for mean_W5, NAT, sd_Last6 and logAct.
 |          Default is [-0.065, -1.08, -0.056, -0.703].
 |      threshold: float, optional
 |          Threshold value for scoring sleep/wake.
 |          Default is 0.0.
 |
 |      Returns
 |      -------
 |
 |      Notes
 |      -----
 |
 |      The output variable PS of the Sadeh algorithm is defined in [2]_ as:
 |
 |      .. math::
 |
 |          PS = 7.601-0.065·mean_W5-1.08·NAT-0.056·sd_Last6-0.703·logAct
 |
 |      with:
 |
 |      * PS &gt;= 0 == sleep, PS &lt; 0 == wake;
 |      * mean_W5, the average number of activity counts during the scored
 |        epoch and the window of five epochs preceding and following it;
 |      * sd_Last6, the standard deviation of the activity counts during
 |        the scored epoch and the five epochs preceding it;
 |      * NAT, the number of epochs with activity level equal to or higher
 |        than 50 but lower than 100 activity counts in a window of 11 minutes
 |        that includes the scored epoch and the five epochs preceding and
 |        following it;
 |      * logAct, the natural logarithm of the number of activity counts during
 |        the scored epoch + 1.
 |
 |      References
 |      ----------
 |
 |      .. [1] Sadeh, A., Alster, J., Urbach, D., &amp; Lavie, P. (1989).
 |             Actigraphically based automatic bedtime sleep-wake scoring:
 |             validity and clinical applications.
 |             Journal of ambulatory monitoring, 2(3), 209-216.
 |      .. [2] Sadeh, A., Sharkey, M., &amp; Carskadon, M. A. (1994).
 |             Activity-Based Sleep-Wake Identification: An Empirical Test of
 |             Methodological Issues. Sleep, 17(3), 201–207.
 |             http://doi.org/10.1093/sleep/17.3.201
 |
 |      Examples
 |      --------
 |
 |  Scripps(self, scale=0.204, window=array([0.0064, 0.0074, 0.0112, 0.0112, 0.0118, 0.0118, 0.0128, 0.0188,
 |         0.028 , 0.0664, 0.03  , 0.0112, 0.01  , 0.    , 0.    , 0.    ,
 |         0.    , 0.    , 0.    , 0.    , 0.    ]), threshold=1.0)
 |      Scripps Clinic algorithm for sleep-wake identification.
 |
 |      Algorithm for automatic sleep scoring based on wrist activity,
 |      developed by Kripke et al [1]_.
 |
 |
 |      Parameters
 |      ----------
 |      scale: float, optional
 |          Scale parameter P
 |          Default is 0.204.
 |      window: np.array, optional
 |          Array of weighting factors :math:`W_{i}`
 |          Default values are identical to those found in the original
 |          publication [1]_.
 |      threshold: float, optional
 |          Threshold value for scoring sleep/wake.
 |          Default is 1.0.
 |
 |      Returns
 |      -------
 |
 |      scripps: pandas.core.Series
 |          Time series containing the `D` scores (0: sleep, 1: wake) for each
 |          epoch.
 |
 |
 |      Notes
 |      -----
 |
 |      The output variable D of the Scripps algorithm is defined in [1]_ as:
 |
 |      .. math::
 |
 |          D = P*(
 |              [W_{-10},\dots,W_{0},\dots,W_{+10}]
 |              \cdot
 |              [A_{-10},\dots,A_{0},\dots,A_{+10}])
 |
 |      with:
 |
 |      * D &lt; 1 == sleep, D &gt;= 1 == wake;
 |      * P, scale factor;
 |      * :math:`W_{0},W_{-1},W_{+1},\dots`, weighting factors for the present
 |        epoch, the previous epoch, the following epoch, etc.;
 |      * :math:`A_{0},A_{-1},A_{+1},\dots`, activity scores for the present
 |        epoch, the previous epoch, the following epoch, etc.
 |
 |
 |      References
 |      ----------
 |
 |      .. [1] Kripke, D. F., Hahn, E. K., Grizas, A. P., Wadiak, K. H.,
 |             Loving, R. T., Poceta, J. S., … Kline, L. E. (2010).
 |             Wrist actigraphic scoring for sleep laboratory patients:
 |             algorithm development. Journal of Sleep Research, 19(4),
 |             612–619. http://doi.org/10.1111/j.1365-2869.2010.00835.x
 |
 |  SleepFragmentation(self)
 |      Sleep Fragmentation is an index of restlessness during the sleep
 |      period expressed as a percentage. The higher the index, the more sleep
 |      is disrupted. ActiLife calculates three values for sleep fragmentation:
 |      movement Index, a fragmentation index, and total sleep fragmentation
 |      Index.
 |      - The Movement Index (MI) is  the percentage of epochs with y-axis
 |      counts greater than zero in the sleep period.
 |      - The Fragmentation Index (FI) is the percentage of one minute periods
 |      of sleep vs. all periods of sleep during the sleep period.
 |      - The Total Sleep Fragmentation Index (SFI) is the sum of the MI and
 |      the FI
 |
 |  SleepMidPoint(self, freq=&#39;15min&#39;, bin_threshold=None, to_td=True, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Sleep midpoint
 |
 |      Center of the mean sleep periods
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Resampling frequency.
 |          Default is &#39;15min&#39;
 |      bin_threshold: bool, optional
 |          If bin_threshold is not set to None, scoring data above this
 |          threshold are set to 1 and to 0 otherwise.
 |          Default is None.
 |      to_td: bool, optional
 |          If set to true, the sleep midpoint is returned as a Timedelta.
 |          Otherwise, it represents the number of minutes since midnight.
 |      algo: str, optional
 |          Sleep scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      smp: float or Timedelta
 |
 |      Notes
 |      -----
 |
 |      Sleep midpoint (SMP) is an index of sleep timing and is calculated
 |      as the following [1]_:
 |
 |      .. math::
 |
 |          SMP = \frac{1440}{2\pi} arctan2\left(
 |                \sum_{j=1}^M\sum_{i=1}^N
 |                s_{i,j} \times sin\left(\frac{2\pi t_i}{1440}\right),
 |                \sum_{j=1}^M\sum_{i=1}^N
 |                s_{i,j} \times cos\left(\frac{2\pi t_i}{1440}\right)
 |                \right)
 |      with:
 |          :math:`t_j`, time of day in minutes at epoch j,
 |          :math:`\delta(s_{i,j}, s_{i+1,j}) = 1` if
 |          :math:`s_{i,j} = s_{i+1,j}` and 0 otherwise.
 |
 |      References
 |      ----------
 |
 |      .. [1] Lunsford-Avery, J. R., Engelhard, M. M., Navar, A. M.,
 |             &amp; Kollins, S. H. (2018). Validation of the Sleep Regularity
 |             Index in Older Adults and Associations with Cardiometabolic
 |             Risk. Scientific Reports, 8(1), 14158.
 |             https://doi.org/10.1038/s41598-018-32402-5
 |
 |      Examples
 |      --------
 |
 |  SleepProfile(self, freq=&#39;15min&#39;, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Normalized sleep daily profile
 |
 |      XXXXX
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Resampling frequency.
 |          Default is &#39;15min&#39;
 |      algo: str, optional
 |          Sleep scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      sleep_prof: YYY
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; raw.SleepProfile()
 |          ZZZZZZZZZZZZZZZZzZZZZZ
 |
 |  SleepRegularityIndex(self, freq=&#39;15min&#39;, bin_threshold=None, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Sleep regularity index
 |
 |      Likelihood that any two time-points (epoch-by-epoch) 24 hours apart are
 |      in the same sleep/wake state, across all days. This index is originally
 |      defined in [1]_ and validated in older adults in [2]_.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Resampling frequency.
 |          Default is &#39;15min&#39;
 |      bin_threshold: bool, optional
 |          If bin_threshold is not set to None, scoring data above this
 |          threshold are set to 1 and to 0 otherwise.
 |          Default is None.
 |      algo: str, optional
 |          Sleep scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      sri: float
 |
 |      Notes
 |      -----
 |
 |      The sleep regularity index (SRI) is defined as:
 |
 |      .. math::
 |
 |          SRI = -100 + \frac{200}{M(N-1)} \sum_{j=1}^M\sum_{i=1}^N
 |                \delta(s_{i,j}, s_{i+1,j})
 |
 |      with:
 |          :math:`\delta(s_{i,j}, s_{i+1,j}) = 1` if
 |          :math:`s_{i,j} = s_{i+1,j}` and 0 otherwise.
 |
 |      References
 |      ----------
 |
 |      .. [1] Phillips, A. J. K., Clerx, W. M., O’Brien, C. S., Sano, A.,
 |             Barger, L. K., Picard, R. W., … Czeisler, C. A. (2017).
 |             Irregular sleep/wake patterns are associated with poorer
 |             academic performance and delayed circadian and sleep/wake
 |             timing. Scientific Reports, 7(1), 1–13.
 |             https://doi.org/10.1038/s41598-017-03171-4
 |      .. [2] Lunsford-Avery, J. R., Engelhard, M. M., Navar, A. M.,
 |             &amp; Kollins, S. H. (2018). Validation of the Sleep Regularity
 |             Index in Older Adults and Associations with Cardiometabolic
 |             Risk. Scientific Reports, 8(1), 14158.
 |             https://doi.org/10.1038/s41598-018-32402-5
 |
 |      Examples
 |      --------
 |
 |  SoD(self, freq=&#39;5min&#39;, binarize=True, bin_threshold=4, whs=4, start=&#39;12:00:00&#39;, period=&#39;5h&#39;, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Sleep over Daytime
 |
 |      Quantify the volume of epochs identified as sleep over daytime (SoD),
 |      using sleep-wake scoring algorithms.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Resampling frequency.
 |          Default is &#39;5min&#39;
 |      binarize: bool, optional
 |          If set to True, the data are binarized when determining the
 |          activity onset and offset times. Only valid if start=&#39;AonT&#39; or
 |          &#39;AoffT&#39;.
 |          Default is True.
 |      bin_threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |      whs: int, optional
 |          Window half size. Only valid if start=&#39;AonT&#39; or &#39;AoffT&#39;.
 |          Default is 4
 |      start: str, optional
 |          Start time of the period of interest.
 |          Default: &#39;12:00:00&#39;
 |          Supported times: &#39;AonT&#39;, &#39;AoffT&#39;, any &#39;HH:MM:SS&#39;
 |      period: str, optional
 |          Period length.
 |          Default is &#39;5h&#39;
 |      algo: str, optional
 |          Sleep scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      sod: pandas.core.Series
 |          Time series containing the epochs of rest (1) and
 |          activity (0) over the specified period.
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; SoD = rawAWD.SoD()
 |          &gt;&gt;&gt; SoD
 |          2018-03-26 04:16:00    1
 |          2018-03-26 04:17:00    1
 |          2018-03-26 04:18:00    1
 |          (...)
 |          2018-04-05 16:59:00    0
 |          2018-04-05 16:59:00    0
 |          2018-04-05 17:00:00    0
 |          Length: 3175, dtype: int64
 |
 |  fSoD(self, freq=&#39;5min&#39;, binarize=True, bin_threshold=4, whs=12, start=&#39;12:00:00&#39;, period=&#39;5h&#39;, algo=&#39;Roenneberg&#39;, *args, **kwargs)
 |      Fraction of Sleep over Daytime
 |
 |      Fractional volume of epochs identified as sleep over daytime (SoD),
 |      using sleep-wake scoring algorithms.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Resampling frequency.
 |          Default is &#39;5min&#39;
 |      binarize: bool, optional
 |          If set to True, the data are binarized when determining the
 |          activity onset and offset times. Only valid if start=&#39;AonT&#39; or
 |          &#39;AoffT&#39;.
 |          Default is True.
 |      bin_threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |      whs: int, optional
 |          Window half size.
 |          Default is 4
 |      start: str, optional
 |          Start time of the period of interest.
 |          Default: &#39;12:00:00&#39;
 |          Supported times: &#39;AonT&#39;, &#39;AoffT&#39;, any &#39;HH:MM:SS&#39;
 |      period: str, optional
 |          Period length.
 |          Default is &#39;10h&#39;
 |      algo: str, optional
 |          Sleep scoring algorithm to use.
 |          Default is &#39;Roenneberg&#39;.
 |      *args
 |          Variable length argument list passed to the scoring algorithm.
 |      **kwargs
 |          Arbitrary keyword arguements passed to the scoring algorithm.
 |
 |      Returns
 |      -------
 |      fsod: float
 |          Fraction of epochs scored as sleep, relatively to the length of
 |          the specified period.
 |
 |      .. warning:: The value of this variable depends on the convention used
 |                   by the underlying sleep scoring algorithm. The expected
 |                   convention is the following:
 |                  * epochs scored as 1 refer to inactivity/sleep
 |
 |                  Otherwise, this variable will actually return the fraction
 |                  of epochs scored as activity. The fraction of sleep can
 |                  simply be recovered by calculating (1-fSOD).
 |
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; raw.fSoD()
 |          0.17763779527559054
 |          &gt;&gt;&gt; raw.fSoD(algo=&#39;ck&#39;)
 |          0.23811023622047245
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from pyActigraphy.metrics.metrics.MetricsMixin:
 |
 |  ADAT(self, binarize=True, threshold=4)
 |      Total average daily activity
 |
 |      Calculate the total activity counts, averaged over all the days.
 |
 |      Parameters
 |      ----------
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |
 |      Returns
 |      -------
 |      adat : int
 |
 |  ADATp(self, period=&#39;7D&#39;, binarize=True, threshold=4, verbose=False)
 |      Total average daily activity per period
 |
 |      Calculate the total activity counts, averaged over each consecutive
 |      period contained in the data. The number of periods
 |
 |      Parameters
 |      ----------
 |      period: str, optional
 |          Time length of the period to be considered. Must be understandable
 |          by pandas.Timedelta
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |      verbose: bool, optional
 |          If set to True, display the number of periods found in the data.
 |          Also display the time not accounted for.
 |
 |      Returns
 |      -------
 |      adatp : list of int
 |
 |  IS(self, freq=&#39;1H&#39;, binarize=True, threshold=4)
 |      Interdaily stability
 |
 |      The Interdaily stability (IS) quantifies the repeatibilty of the
 |      daily rest-activity pattern over each day contained in the activity
 |      recording.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Data resampling `frequency string
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.
 |          Default is &#39;1H&#39;.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |
 |      Returns
 |      -------
 |      is: float
 |
 |
 |      Notes
 |      -----
 |
 |      This variable is defined in ref [1]_:
 |
 |      .. math::
 |
 |          IS = \frac{d^{24h}}{d^{1h}}
 |
 |      with:
 |
 |      .. math::
 |
 |          d^{1h} = \sum_{i}^{n}\frac{\left(x_{i}-\bar{x}\right)^{2}}{n}
 |
 |      where :math:`x_{i}` is the number of active (counts higher than a
 |      predefined threshold) minutes during the :math:`i^{th}` period,
 |      :math:`\bar{x}` is the mean of all data and :math:`n` is the number of
 |      periods covered by the actigraphy data and with:
 |
 |      .. math::
 |
 |          d^{24h} = \sum_{i}^{p} \frac{
 |                    \left( \bar{x}_{h,i} - \bar{x} \right)^{2}
 |                    }{p}
 |
 |      where :math:`\bar{x}^{h,i}` is the average number of active minutes
 |      over the :math:`i^{th}` period and :math:`p` is the number of periods
 |      per day. The average runs over all the days.
 |
 |      For the record, tt is the 24h value from the chi-square periodogram
 |      (Sokolove and Bushel1 1978).
 |
 |      References
 |      ----------
 |
 |      .. [1] Witting W., Kwa I.H., Eikelenboom P., Mirmiran M., Swaab D.F.
 |             Alterations in the circadian rest–activity rhythm in aging and
 |             Alzheimer׳s disease. Biol Psychiatry. 1990;27:563–572.
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.IS()
 |          0.6900175913031027
 |          &gt;&gt;&gt; rawAWD.IS(freq=&#39;30min&#39;, binarize=True, threshold=4)
 |          0.6245582891144925
 |          &gt;&gt;&gt; rawAWD.IS(freq=&#39;1H&#39;, binarize=False)
 |          0.5257020914453097
 |
 |  ISm(self, freqs=[&#39;1T&#39;, &#39;2T&#39;, &#39;3T&#39;, &#39;4T&#39;, &#39;5T&#39;, &#39;6T&#39;, &#39;8T&#39;, &#39;9T&#39;, &#39;10T&#39;, &#39;12T&#39;, &#39;15T&#39;, &#39;16T&#39;, &#39;18T&#39;, &#39;20T&#39;, &#39;24T&#39;, &#39;30T&#39;, &#39;32T&#39;, &#39;36T&#39;, &#39;40T&#39;, &#39;45T&#39;, &#39;48T&#39;, &#39;60T&#39;], binarize=True, threshold=4)
 |      Average interdaily stability
 |
 |      ISm [1]_ is the average of the IS values obtained with resampling
 |      periods divisors of 1440 between 1 and 60 min.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Data resampling `frequency strings
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is set to 4.
 |
 |      Returns
 |      -------
 |      ism: float
 |
 |      Notes
 |      -----
 |
 |      By default, the resampling periods are 1, 2, 3, 4, 5, 6, 8, 9, 10, 12,
 |      15, 16, 18, 20, 24, 30, 32, 36, 40, 45, 48 and 60 min.
 |
 |      References
 |      ----------
 |
 |      .. [1] Gonçalves, B. S., Cavalcanti, P. R., Tavares, G. R.,
 |             Campos, T. F., &amp; Araujo, J. F. (2014). Nonparametric methods in
 |             actigraphy: An update. Sleep science (Sao Paulo, Brazil), 7(3),
 |             158-64.
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.ISm()
 |          0.5758268227551039
 |          &gt;&gt;&gt; rawAWD.ISm(binarize=False)
 |          0.3915874151855646
 |          &gt;&gt;&gt; rawAWD.ISm(freqs=[&#39;10min&#39;,&#39;30min&#39;,&#39;1H&#39;], binarize=False)
 |          0.44598210450842063
 |
 |  ISp(self, period=&#39;7D&#39;, freq=&#39;1H&#39;, binarize=True, threshold=4, verbose=False)
 |      Interdaily stability per period
 |
 |      The IS is calculated for each consecutive period found in the
 |      actigraphy recording.
 |
 |      Parameters
 |      ----------
 |      period: str, optional
 |          Time period for the calculation of IS
 |          Default is &#39;7D&#39;.
 |      freq: str, optional
 |          Data resampling `frequency string
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.
 |          Default is &#39;1H&#39;.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |      verbose: bool, optional
 |          If set to True, display the number of periods found in the activity
 |          recording, as well as the time not accounted for.
 |          Default is False.
 |
 |      Returns
 |      -------
 |      isp: list of float
 |
 |
 |      Notes
 |      -----
 |
 |      Periods are consecutive and all of the required duration. If the last
 |      consecutive period is shorter than required, the IS is not calculated
 |      for that period.
 |
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.duration()
 |          Timedelta(&#39;12 days 18:41:00&#39;)
 |          &gt;&gt;&gt; rawAWD.ISp(period=&#39;5D&#39;,verbose=True)
 |          Number of periods: 2
 |          Time unaccounted for: 2 days, 19h, 0m, 0s
 |          [0.7565263007902066, 0.866544730769211]
 |
 |  IV(self, freq=&#39;1H&#39;, binarize=True, threshold=4)
 |      Intradaily variability
 |
 |      The Intradaily Variability (IV) quantifies the variability of the
 |      activity recording. This variable thus measures the rest or activity
 |      fragmentation.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Data resampling `frequency string
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.
 |          Default is &#39;1H&#39;.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |
 |      Returns
 |      -------
 |      iv: float
 |
 |      Notes
 |      -----
 |
 |      It is defined in ref [1]_:
 |
 |      .. math::
 |
 |          IV = \frac{c^{1h}}{d^{1h}}
 |
 |      with:
 |
 |      .. math::
 |
 |          d^{1h} = \sum_{i}^{n}\frac{\left(x_{i}-\bar{x}\right)^{2}}{n}
 |
 |      where :math:`x_{i}` is the number of active (counts higher than a
 |      predefined threshold) minutes during the :math:`i^{th}` period,
 |      :math:`\bar{x}` is the mean of all data and :math:`n` is the number of
 |      periods covered by the actigraphy data,
 |
 |      and with:
 |
 |      .. math::
 |
 |          c^{1h} = \sum_{i}^{n-1} \frac{
 |                      \left( x_{i+1} - x_{i} \right)^{2}
 |                   }{n-1}
 |
 |      References
 |      ----------
 |
 |      .. [1] Witting W., Kwa I.H., Eikelenboom P., Mirmiran M., Swaab D.F.
 |             Alterations in the circadian rest–activity rhythm in aging and
 |             Alzheimer׳s disease. Biol Psychiatry. 1990;27:563–572.
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.IV()
 |          0.46185426426324316
 |          &gt;&gt;&gt; rawAWD.IV(freq=&#39;30min&#39;, binarize=True, threshold=4)
 |          0.4150769573937417
 |          &gt;&gt;&gt; rawAWD.IV(freq=&#39;1H&#39;, binarize=False)
 |          0.7859579446494547
 |
 |  IVm(self, freqs=[&#39;1T&#39;, &#39;2T&#39;, &#39;3T&#39;, &#39;4T&#39;, &#39;5T&#39;, &#39;6T&#39;, &#39;8T&#39;, &#39;9T&#39;, &#39;10T&#39;, &#39;12T&#39;, &#39;15T&#39;, &#39;16T&#39;, &#39;18T&#39;, &#39;20T&#39;, &#39;24T&#39;, &#39;30T&#39;, &#39;32T&#39;, &#39;36T&#39;, &#39;40T&#39;, &#39;45T&#39;, &#39;48T&#39;, &#39;60T&#39;], binarize=True, threshold=4)
 |      Average intradaily variability
 |
 |      IVm [1]_ is the average of the IV values obtained with resampling
 |      periods divisors of 1440 between 1 and 60 min.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Data resampling `frequency strings
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is set to 4.
 |
 |      Returns
 |      -------
 |      ivm: float
 |
 |      Notes
 |      -----
 |
 |      By default, the resampling periods are 1, 2, 3, 4, 5, 6, 8, 9, 10, 12,
 |      15, 16, 18, 20, 24, 30, 32, 36, 40, 45, 48 and 60 min.
 |
 |      References
 |      ----------
 |
 |      .. [1] Gonçalves, B. S., Cavalcanti, P. R., Tavares, G. R.,
 |             Campos, T. F., &amp; Araujo, J. F. (2014). Nonparametric methods in
 |             actigraphy: An update. Sleep science (Sao Paulo, Brazil), 7(3),
 |             158-64.
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.IVm()
 |          0.3482306825356382
 |          &gt;&gt;&gt; rawAWD.IVm(binarize=False)
 |          0.6414533006190071
 |          &gt;&gt;&gt; rawAWD.IVm(freqs=[&#39;10min&#39;,&#39;30min&#39;,&#39;1H&#39;], binarize=False)
 |          0.7124465677737196
 |
 |  IVp(self, period=&#39;7D&#39;, freq=&#39;1H&#39;, binarize=True, threshold=4, verbose=False)
 |      Intradaily variability per period
 |
 |      The IV is calculated for each consecutive period found in the
 |      actigraphy recording.
 |
 |      Parameters
 |      ----------
 |      period: str, optional
 |          Time period for the calculation of IS
 |          Default is &#39;7D&#39;.
 |      freq: str, optional
 |          Data resampling `frequency string
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_.
 |          Default is &#39;1H&#39;.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |      verbose: bool, optional
 |          If set to True, display the number of periods found in the activity
 |          recording, as well as the time not accounted for.
 |          Default is False.
 |
 |      Returns
 |      -------
 |      ivp: list of float
 |
 |
 |      Notes
 |      -----
 |
 |      Periods are consecutive and all of the required duration. If the last
 |      consecutive period is shorter than required, the IV is not calculated
 |      for that period.
 |
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.duration()
 |          Timedelta(&#39;12 days 18:41:00&#39;)
 |          &gt;&gt;&gt; rawAWD.IVp(period=&#39;5D&#39;,verbose=True)
 |          Number of periods: 2
 |          Time unaccounted for: 2 days, 19h, 0m, 0s
 |          [0.4011232866522594, 0.5340044506337185]
 |
 |  L5(self, binarize=True, threshold=4)
 |      L5
 |
 |      Mean activity during the 5 least active hours of the day.
 |
 |      Parameters
 |      ----------
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |
 |      Returns
 |      -------
 |      l5: float
 |
 |
 |      Notes
 |      -----
 |
 |      The L5 [1]_ variable is calculated as the mean, per acquisition period,
 |      of the average daily activities during the 5 least active hours.
 |
 |      .. warning:: The value of this variable depends on the length of the
 |                   acquisition period.
 |
 |      References
 |      ----------
 |
 |      .. [1] Van Someren, E.J.W., Lijzenga, C., Mirmiran, M., Swaab, D.F.
 |             (1997). Long-Term Fitness Training Improves the Circadian
 |             Rest-Activity Rhythm in Healthy Elderly Males.
 |             Journal of Biological Rhythms, 12(2), 146–156.
 |             http://doi.org/10.1177/074873049701200206
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.L5()
 |          0.XXXX
 |          &gt;&gt;&gt; rawAWD.L5(binarize=False)
 |          0.XXXX
 |
 |  L5p(self, period=&#39;7D&#39;, binarize=True, threshold=4, verbose=False)
 |      L5 per period
 |
 |      The L5 variable is calculated for each consecutive period found in the
 |      actigraphy recording.
 |
 |      Parameters
 |      ----------
 |      period: str, optional
 |          Time period for the calculation of IS
 |          Default is &#39;7D&#39;.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |      verbose: bool, optional
 |          If set to True, display the number of periods found in the activity
 |          recording, as well as the time not accounted for.
 |          Default is False.
 |
 |      Returns
 |      -------
 |      l5p: list of float
 |
 |
 |      Notes
 |      -----
 |
 |      The L5 [1]_ variable is calculated as the mean, per acquisition period,
 |      of the average daily activities during the 5 least active hours.
 |
 |      .. warning:: The value of this variable depends on the length of the
 |                   acquisition period.
 |
 |      References
 |      ----------
 |
 |      .. [1] Van Someren, E.J.W., Lijzenga, C., Mirmiran, M., Swaab, D.F.
 |             (1997). Long-Term Fitness Training Improves the Circadian
 |             Rest-Activity Rhythm in Healthy Elderly Males.
 |             Journal of Biological Rhythms, 12(2), 146–156.
 |             http://doi.org/10.1177/074873049701200206
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.duration()
 |          Timedelta(&#39;12 days 18:41:00&#39;)
 |          &gt;&gt;&gt; rawAWD.L5p(period=&#39;5D&#39;,verbose=True)
 |          Number of periods: 2
 |          Time unaccounted for: 2 days, 19h, 0m, 0s
 |          [0.XXXX, 0.XXXX]
 |
 |  M10(self, binarize=True, threshold=4)
 |      M10
 |
 |      Mean activity during the 10 most active hours of the day.
 |
 |      Parameters
 |      ----------
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |
 |      Returns
 |      -------
 |      m10: float
 |
 |
 |      Notes
 |      -----
 |
 |      The M10 [1]_ variable is calculated as the mean, per acquisition period
 |      , of the average daily activities during the 10 most active hours.
 |
 |      .. warning:: The value of this variable depends on the length of the
 |                   acquisition period.
 |
 |      References
 |      ----------
 |
 |      .. [1] Van Someren, E.J.W., Lijzenga, C., Mirmiran, M., Swaab, D.F.
 |             (1997). Long-Term Fitness Training Improves the Circadian
 |             Rest-Activity Rhythm in Healthy Elderly Males.
 |             Journal of Biological Rhythms, 12(2), 146–156.
 |             http://doi.org/10.1177/074873049701200206
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.M10()
 |          0.XXXX
 |          &gt;&gt;&gt; rawAWD.M10(binarize=False)
 |          0.XXXX
 |
 |  M10p(self, period=&#39;7D&#39;, binarize=True, threshold=4, verbose=False)
 |      M10 per period
 |
 |      The M10 variable is calculated for each consecutive period found in the
 |      actigraphy recording.
 |
 |      Parameters
 |      ----------
 |      period: str, optional
 |          Time period for the calculation of IS
 |          Default is &#39;7D&#39;.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |      verbose: bool, optional
 |          If set to True, display the number of periods found in the activity
 |          recording, as well as the time not accounted for.
 |          Default is False.
 |
 |      Returns
 |      -------
 |      m10p: list of float
 |
 |
 |      Notes
 |      -----
 |
 |      The M10 [1]_ variable is calculated as the mean, per acquisition period
 |      , of the average daily activities during the 10 most active hours.
 |
 |      .. warning:: The value of this variable depends on the length of the
 |                   acquisition period.
 |
 |      References
 |      ----------
 |
 |      .. [1] Van Someren, E.J.W., Lijzenga, C., Mirmiran, M., Swaab, D.F.
 |             (1997). Long-Term Fitness Training Improves the Circadian
 |             Rest-Activity Rhythm in Healthy Elderly Males.
 |             Journal of Biological Rhythms, 12(2), 146–156.
 |             http://doi.org/10.1177/074873049701200206
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.duration()
 |          Timedelta(&#39;12 days 18:41:00&#39;)
 |          &gt;&gt;&gt; rawAWD.M10p(period=&#39;5D&#39;,verbose=True)
 |          Number of periods: 2
 |          Time unaccounted for: 2 days, 19h, 0m, 0s
 |          [0.XXXX, 0.XXXX]
 |
 |  RA(self, binarize=True, threshold=4)
 |      Relative rest/activity amplitude
 |
 |      Relative amplitude between the mean activity during the 10 most active
 |      hours of the day and the mean activity during the 5 least active hours
 |      of the day.
 |
 |      Parameters
 |      ----------
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |
 |      Returns
 |      -------
 |      ra: float
 |
 |
 |      Notes
 |      -----
 |
 |      The RA [1]_ variable is calculated as:
 |
 |      .. math::
 |
 |          RA = \frac{M10 - L5}{M10 + L5}
 |
 |      References
 |      ----------
 |
 |      .. [1] Van Someren, E.J.W., Lijzenga, C., Mirmiran, M., Swaab, D.F.
 |             (1997). Long-Term Fitness Training Improves the Circadian
 |             Rest-Activity Rhythm in Healthy Elderly Males.
 |             Journal of Biological Rhythms, 12(2), 146–156.
 |             http://doi.org/10.1177/074873049701200206
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.RA()
 |          0.XXXX
 |          &gt;&gt;&gt; rawAWD.RA(binarize=False)
 |          0.XXXX
 |
 |  RAp(self, period=&#39;7D&#39;, binarize=True, threshold=4, verbose=False)
 |      RA per period
 |
 |      The RA variable is calculated for each consecutive period found in the
 |      actigraphy recording.
 |
 |      Parameters
 |      ----------
 |      period: str, optional
 |          Time period for the calculation of IS
 |          Default is &#39;7D&#39;.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |          Default is 4.
 |      verbose: bool, optional
 |          If set to True, display the number of periods found in the activity
 |          recording, as well as the time not accounted for.
 |          Default is False.
 |
 |      Returns
 |      -------
 |      rap: list of float
 |
 |
 |      Notes
 |      -----
 |
 |      The RA [1]_ variable is calculated as:
 |
 |      .. math::
 |
 |          RA = \frac{M10 - L5}{M10 + L5}
 |
 |      References
 |      ----------
 |
 |      .. [1] Van Someren, E.J.W., Lijzenga, C., Mirmiran, M., Swaab, D.F.
 |             (1997). Long-Term Fitness Training Improves the Circadian
 |             Rest-Activity Rhythm in Healthy Elderly Males.
 |             Journal of Biological Rhythms, 12(2), 146–156.
 |             http://doi.org/10.1177/074873049701200206
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.duration()
 |          Timedelta(&#39;12 days 18:41:00&#39;)
 |          &gt;&gt;&gt; rawAWD.RAp(period=&#39;5D&#39;,verbose=True)
 |          Number of periods: 2
 |          Time unaccounted for: 2 days, 19h, 0m, 0s
 |          [0.XXXX, 0.XXXX]
 |
 |  average_daily_activity(self, freq=&#39;5min&#39;, cyclic=False, binarize=True, threshold=4, time_origin=None, whs=&#39;1h&#39;)
 |      Average daily activity distribution
 |
 |      Calculate the daily profile of activity. Data are averaged over all the
 |      days.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Data resampling frequency.
 |          Cf. #timeseries-offset-aliases in
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;.
 |      cyclic: bool, optional
 |          If set to True, two daily profiles are concatenated to ensure
 |          continuity between the last point of the day and the first one.
 |          Default is False.
 |      binarize: bool, optional
 |          If set to True, the data are binarized.
 |          Default is True.
 |      threshold: int, optional
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |      time_origin: str or pd.Timedelta, optional
 |          If not None, origin of the time axis for the daily profile.
 |          Original time bins are translated as time delta with respect to
 |          this new origin.
 |          Default is None
 |          Supported time string: &#39;AonT&#39;, &#39;AoffT&#39;, any &#39;HH:MM:SS&#39;
 |      whs: str, optional
 |          Window half size parameter for the detection of the activity
 |          onset/offset time. Relevant only if time_origin is set to
 |          &#39;AonT&#39; or AoffT&#39;.
 |          Default is &#39;1h&#39;.
 |
 |      Returns
 |      -------
 |      raw : pandas.Series
 |          A Series containing the daily activity profile with a 24h index.
 |
 |  average_daily_light(self, freq=&#39;5min&#39;, cyclic=False)
 |      Average daily light distribution
 |
 |      Calculate the daily profile of light exposure (in lux). Data are
 |      averaged over all the days.
 |
 |      Parameters
 |      ----------
 |      freq: str, optional
 |          Data resampling frequency.
 |          Cf. #timeseries-offset-aliases in
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;.
 |      cyclic: bool, optional
 |          If set to True, two daily profiles are concatenated to ensure
 |          continuity between the last point of the day and the first one.
 |          Default is False.
 |
 |      Returns
 |      -------
 |      raw : pandas.Series
 |          A Series containing the daily profile of light exposure with a 24h
 |          index.
 |
 |  kAR(self, threshold, start=None, period=None, frac=0.3, it=0, logit=False, freq=None, offset=&#39;15min&#39;)
 |      Rest-&gt;Activity transition probability
 |
 |      Weighted average value of pAR(t) within the constant regions, defined
 |      as the longest stretch within which the LOWESS curve varied by no more
 |      than 1 standard deviation of the pAR(t) curve [1]_.
 |
 |      Parameters
 |      ----------
 |      threshold: int
 |          Above this threshold, data are classified as active (1) and as
 |          rest (0) otherwise.
 |      start: str, optional
 |          If not None, the actigraphy recording is truncated to
 |          &#39;start:start+period&#39;, each day. Start string format: &#39;HH:MM:SS&#39;.
 |          Special keywords (&#39;AonT&#39; or &#39;AoffT&#39;) are allowed. In this case, the
 |          start is set to the activity onset (&#39;AonT&#39;) or offset (&#39;AoffT&#39;)
 |          time derived from the daily profile. Cf sleep.AonT/AoffT functions
 |          for more informations.
 |          Default is None
 |      period: str, optional
 |          Time period for the calculation of pRA.
 |          Default is None.
 |      frac: float
 |          Fraction of the data used when estimating each value.
 |          Default is 0.3.
 |      it: int
 |          Number of residual-based reweightings to perform.
 |          Default is 0.
 |      logit: bool, optional
 |          If True, the kRA value is logit-transformed (ln(p/1-p)). Useful
 |          when kRA is used in a regression model.
 |          Default is False.
 |      freq: str, optional
 |          Data resampling `frequency string
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_
 |          applied to the daily profile if start=&#39;AonT&#39; or &#39;AoffT&#39;.
 |          Default is None.
 |      offset: str, optional
 |          Time offset with respect to the activity onset and offset times
 |          used as start times.
 |          Default is &#39;15min&#39;.
 |
 |      Returns
 |      -------
 |      kar: float
 |
 |      References
 |      ----------
 |
 |      .. [1] Lim, A. S. P., Yu, L., Costa, M. D., Buchman, A. S.,
 |             Bennett, D. A., Leurgans, S. E., &amp; Saper, C. B. (2011).
 |             Quantification of the Fragmentation of Rest-Activity Patterns in
 |             Elderly Individuals Using a State Transition Analysis. Sleep,
 |             34(11), 1569–1581. http://doi.org/10.5665/sleep.1400
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.kAR(4)
 |          0.041397590252332916
 |          &gt;&gt;&gt; rawAWD.kAR(4, start=&#39;08:00:00&#39;, period=&#39;12H&#39;)
 |          0.04372712642257519
 |
 |  kRA(self, threshold, start=None, period=None, frac=0.3, it=0, logit=False, freq=None, offset=&#39;15min&#39;)
 |      Rest-&gt;Activity transition probability
 |
 |      Weighted average value of pRA(t) within the constant regions, defined
 |      as the longest stretch within which the LOWESS curve varied by no more
 |      than 1 standard deviation of the pRA(t) curve [1]_.
 |
 |      Parameters
 |      ----------
 |      threshold: int
 |          Above this threshold, data are classified as active (1) and as
 |          rest (0) otherwise.
 |      start: str, optional
 |          If not None, the actigraphy recording is truncated to
 |          &#39;start:start+period&#39;, each day. Start string format: &#39;HH:MM:SS&#39;.
 |          Special keywords (&#39;AonT&#39; or &#39;AoffT&#39;) are allowed. In this case, the
 |          start is set to the activity onset (&#39;AonT&#39;) or offset (&#39;AoffT&#39;)
 |          time derived from the daily profile. Cf sleep.AonT/AoffT functions
 |          for more informations.
 |          Default is None
 |      period: str, optional
 |          Time period for the calculation of pRA.
 |          Default is None.
 |      frac: float, optional
 |          Fraction of the data used when estimating each value.
 |          Default is 0.3.
 |      it: int, optional
 |          Number of residual-based reweightings to perform.
 |          Default is 0.
 |      logit: bool, optional
 |          If True, the kRA value is logit-transformed (ln(p/1-p)). Useful
 |          when kRA is used in a regression model.
 |          Default is False.
 |      freq: str, optional
 |          Data resampling `frequency string
 |          &lt;https://pandas.pydata.org/pandas-docs/stable/timeseries.html&gt;`_
 |          applied to the daily profile if start=&#39;AonT&#39; or &#39;AoffT&#39;.
 |          Default is None.
 |      offset: str, optional
 |          Time offset with respect to the activity onset and offset times
 |          used as start times.
 |          Default is &#39;15min&#39;.
 |
 |      Returns
 |      -------
 |      kra: float
 |
 |      References
 |      ----------
 |
 |      .. [1] Lim, A. S. P., Yu, L., Costa, M. D., Buchman, A. S.,
 |             Bennett, D. A., Leurgans, S. E., &amp; Saper, C. B. (2011).
 |             Quantification of the Fragmentation of Rest-Activity Patterns in
 |             Elderly Individuals Using a State Transition Analysis. Sleep,
 |             34(11), 1569–1581. http://doi.org/10.5665/sleep.1400
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; rawAWD.kRA(4)
 |          0.09144435545010564
 |          &gt;&gt;&gt; rawAWD.kRA(4, start=&#39;00:00:00&#39;, period=&#39;8H&#39;)
 |          0.13195826220778709
 |
 |  pAR(self, threshold, start=None, period=None)
 |      Activity-&gt;Rest transition probability distribution
 |
 |      Conditional probability, pAR(t), that an individual would be
 |      active at time (t+1) given that the individual had been continuously
 |      resting for the preceding t epochs, defined in [1]_ as:
 |
 |      .. math::
 |          pAR(t) = p(R|A_t) = \frac{N_t - N_{t+1}}{N_t}
 |
 |      with :math:`N_t`, the total number of sequences of activity (i.e.
 |      activity above threshold) of duration :math:`t` or longer.
 |
 |      Parameters
 |      ----------
 |      threshold: int
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |      start: str, optional
 |          If not None, the actigraphy recording is truncated to
 |          &#39;start:start+period&#39;, each day. Start string format: &#39;HH:MM:SS&#39;.
 |          Default is None
 |      period: str, optional
 |          Time period for the calculation of pAR.
 |          Default is None.
 |
 |      Returns
 |      -------
 |      par: pandas.core.series.Series
 |          Transition probabilities (pAR(t)), calculated for all t values.
 |      par_weights: pandas.core.series.Series
 |          Weights are defined as the square root of the number of activity
 |          sequences contributing to each probability estimate.
 |
 |      Notes
 |      -----
 |
 |      pAR is corrected for discontinuities due to sparse data, as defined in
 |      [1]_.
 |
 |      References
 |      ----------
 |
 |      .. [1] Lim, A. S. P., Yu, L., Costa, M. D., Buchman, A. S.,
 |             Bennett, D. A., Leurgans, S. E., &amp; Saper, C. B. (2011).
 |             Quantification of the Fragmentation of Rest-Activity Patterns in
 |             Elderly Individuals Using a State Transition Analysis. Sleep,
 |             34(11), 1569–1581. http://doi.org/10.5665/sleep.1400
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; pAR, pAR_weights = rawAWD.pAR(4, start=&#39;00:00:00&#39;, period=&#39;8H&#39;)
 |          &gt;&gt;&gt; pAR
 |          counts
 |          1      0.169043
 |          2      0.144608
 |          3      0.163324
 |          (...)
 |          481    0.001157
 |          Name: counts, dtype: float64
 |
 |  pRA(self, threshold, start=None, period=None)
 |      Rest-&gt;Activity transition probability distribution
 |
 |      Conditional probability, pRA(t), that an individual would be
 |      resting at time (t+1) given that the individual had been continuously
 |      active for the preceding t epochs, defined in [1]_ as:
 |
 |      .. math::
 |          pRA(t) = p(A|R_t) = \frac{N_t - N_{t+1}}{N_t}
 |
 |      with :math:`N_t`, the total number of sequences of rest (i.e. activity
 |      below threshold) of duration :math:`t` or longer.
 |
 |      Parameters
 |      ----------
 |      threshold: int
 |          If binarize is set to True, data above this threshold are set to 1
 |          and to 0 otherwise.
 |      start: str, optional
 |          If not None, the actigraphy recording is truncated to
 |          &#39;start:start+period&#39;, each day. Start string format: &#39;HH:MM:SS&#39;.
 |          Default is None
 |      period: str, optional
 |          Time period for the calculation of pRA.
 |          Default is None.
 |
 |      Returns
 |      -------
 |      pra: pandas.core.series.Series
 |          Transition probabilities (pRA(t)), calculated for all t values.
 |      pra_weights: pandas.core.series.Series
 |          Weights are defined as the square root of the number of activity
 |          sequences contributing to each probability estimate.
 |
 |      Notes
 |      -----
 |
 |      pRA is corrected for discontinuities due to sparse data, as defined in
 |      [1]_.
 |
 |      References
 |      ----------
 |
 |      .. [1] Lim, A. S. P., Yu, L., Costa, M. D., Buchman, A. S.,
 |             Bennett, D. A., Leurgans, S. E., &amp; Saper, C. B. (2011).
 |             Quantification of the Fragmentation of Rest-Activity Patterns in
 |             Elderly Individuals Using a State Transition Analysis. Sleep,
 |             34(11), 1569–1581. http://doi.org/10.5665/sleep.1400
 |
 |      Examples
 |      --------
 |
 |          &gt;&gt;&gt; import pyActigraphy
 |          &gt;&gt;&gt; rawAWD = pyActigraphy.io.read_raw_awd(fpath + &#39;SUBJECT_01.AWD&#39;)
 |          &gt;&gt;&gt; pRA, pRA_weights = rawAWD.pRA(4, start=&#39;00:00:00&#39;, period=&#39;8H&#39;)
 |          &gt;&gt;&gt; pRA
 |          counts
 |          1      0.169043
 |          2      0.144608
 |          3      0.163324
 |          (...)
 |          481    0.001157
 |          Name: counts, dtype: float64
 |
 |  ----------------------------------------------------------------------
 |  Methods inherited from pyActigraphy.filters.filters.FiltersMixin:
 |
 |  add_mask_period(self, start, stop)
 |      Add a period to the inactivity mask
 |
 |      Parameters
 |      ----------
 |      start: str
 |          Start time (YYYY-MM-DD HH:MM:SS) of the inactivity period.
 |      stop: str
 |          Stop time (YYYY-MM-DD HH:MM:SS) of the inactivity period.
 |
 |  add_mask_periods(self, input_fname, *args, **kwargs)
 |      Add periods to the inactivity mask
 |
 |      Function to read start and stop times from a Mask log file. Supports
 |      different file format (.ods, .xls(x), .csv).
 |
 |      Parameters
 |      ----------
 |      input_fname: str
 |          Path to the log file.
 |      *args
 |          Variable length argument list passed to the subsequent reader
 |          function.
 |      **kwargs
 |          Arbitrary keyword arguments passed to the subsequent reader
 |          function.
 |
 |  create_inactivity_mask(self, duration)
 |      Create a mask for inactivity (count equal to zero) periods.
 |
 |      This mask has the same length as its underlying data and can be used
 |      to offuscate inactive periods where the actimeter has most likely been
 |      removed.
 |      Warning: use a sufficiently long duration in order not to mask sleep
 |      periods.
 |      A minimal duration corresponding to two hours seems reasonable.
 |
 |      Parameters
 |      ----------
 |      duration: int or str
 |          Minimal number of consecutive zeroes for an inactive period.
 |          Time offset strings (ex: &#39;90min&#39;) can also be used.

</pre></div></div>
</div>
<div class="section" id="Set-activity-and-light-data-(if-available)">
<h3>Set activity and light data (if available)<a class="headerlink" href="#Set-activity-and-light-data-(if-available)" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">raw</span> <span class="o">=</span> <span class="n">BaseRaw</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s2">&quot;myName&quot;</span><span class="p">,</span>
    <span class="n">uuid</span><span class="o">=</span><span class="s1">&#39;DeviceId&#39;</span><span class="p">,</span>
    <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;Pandas&#39;</span><span class="p">,</span>
    <span class="n">axial_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">start_time</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
    <span class="n">period</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
    <span class="n">frequency</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">freq</span><span class="p">,</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Activity&#39;</span><span class="p">],</span>
    <span class="n">light</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Light&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">raw</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[15]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>2020-01-01 00:00:00     9.803906
2020-01-01 00:01:00    11.322234
2020-01-01 00:02:00     8.204245
2020-01-01 00:03:00     8.867003
2020-01-01 00:04:00     9.187778
                         ...
2020-01-07 23:55:00     7.516059
2020-01-07 23:56:00    10.156999
2020-01-07 23:57:00    10.241579
2020-01-07 23:58:00    10.751310
2020-01-07 23:59:00     9.172097
Freq: 60S, Name: Activity, Length: 10080, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="section" id="Set-up-a-mask">
<h3>Set up a mask<a class="headerlink" href="#Set-up-a-mask" title="Permalink to this headline">¶</a></h3>
<p>Most devices that have a wear sensor return this information as a binary
time series with “1” when the device is most likely not worn and “0”
otherwise. In pyActigraphy, this information can be used to create a
mask and thus invalidate the corresponding data points (set to “0” most
probably). However, the mask, the value “1” correspond to “no masking”.
So, depending on your “non-wear” data, be careful to transform them
appropriately:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Here, I assume that 0: the device is worn, 1: device not worn.</span>
<span class="c1"># As mentioned aboce, for the mask, 1: no masking. (NB: it is a convolution: data*mask)</span>
<span class="n">raw</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Non-wear&#39;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Tests">
<h2>Tests<a class="headerlink" href="#Tests" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">raw</span><span class="o">.</span><span class="n">duration</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[17]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&lt;604800 * Seconds&gt;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">raw</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[18]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>10080
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">raw</span><span class="o">.</span><span class="n">ADAT</span><span class="p">(</span><span class="n">binarize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[19]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>14254.226390926031
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">raw</span><span class="o">.</span><span class="n">IV</span><span class="p">(</span><span class="n">binarize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>1.0947050893977417
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># If you want to mask the data</span>
<span class="n">raw</span><span class="o">.</span><span class="n">mask_inactivity</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># For a gaussian noise, IV should be close to 2.</span>
<span class="n">raw</span><span class="o">.</span><span class="n">IV</span><span class="p">(</span><span class="n">binarize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[22]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>2.0822912245090293
</pre></div>
</div>
</div>
<p>The masking seems to work!</p>
<p>Et voilà!</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018-2020, Grégory Hammad.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 3.1.0.<br/>
    </p>
  </div>
</footer>
  </body>
</html>